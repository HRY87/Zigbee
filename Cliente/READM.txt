Configuraci√≥n del Cliente Zigbee(ESP32-C6)

Descripci√≥n
Este proyecto implementa un Zigbee End Device (Cliente) utilizando el ESP32-C6.
El cliente se une a una red Zigbee existente (creada por un coordinador) y puede:

Responder a comandos del coordinador (por ejemplo, encender/apagar).
Enviar estados o informaci√≥n (por ejemplo, estado de una luz o sensor).

Este ejemplo est√° dise√±ado para funcionar junto con el proyecto Coordinador que act√∫a como coordinador.

Requisitos previos

ESP-IDF v5.3.4 o superior
Visual Studio Code con la extensi√≥n ESP-IDF
Python 3.8+
ESP32-C6
Cable USB o JTAG
Puerto COM disponible (por ejemplo, COM9 en Windows)

ADVERTENCIA: Un Coordinador Zigbee activo (por ejemplo, el proyecto Coordinador corriendo en otro ESP32-C6)

Estructura del proyecto
Cliente/
‚îú‚îÄ‚îÄ main/
‚îÇ   ‚îú‚îÄ‚îÄ CMakeLists.txt
‚îÇ   ‚îî‚îÄ‚îÄ main.c
‚îú‚îÄ‚îÄ CMakeLists.txt
‚îú‚îÄ‚îÄ sdkconfig
‚îú‚îÄ‚îÄ partition.csv
‚îî‚îÄ‚îÄ README.txt

Configuraci√≥n inicial en VS Code

Abre la carpeta esp_zb_light/ en Visual Studio Code.
Aseg√∫rate de que la extensi√≥n de ESP-IDF est√© activa.
En la barra inferior, configur√° lo siguiente:

Acci√≥n	Descripci√≥n	Comando equivalente
Versi√≥n de ESP-IDF	Seleccion√° v5.3.4 o superior	idf.py --version
M√©todo de Flash	UART o JTAG	(Configuraci√≥n de extensi√≥n)
Puerto COM	Seleccion√° tu puerto (ej. COM9)	idf.py -p COM9 flash
Target (Dispositivo)	Seleccion√° esp32c6	idf.py set-target esp32c6

Configuraci√≥n del proyecto (menuconfig)
Abre la terminal ESP-IDF (√≠cono üíª o Ctrl + Shift + P ‚Üí ESP-IDF: Open ESP-IDF Terminal).

Ejecut√°: idf.py menuconfig

Dentro del men√∫, configur√° lo siguiente:

Zigbee
Ruta: Component config ‚Üí Zigbee

Opciones:
1) Enable Zigbee stack
2) Zigbee role: End Device

(Opcional) Configur√° el canal Zigbee y PAN ID si quer√©s forzar el enlace con un coordinador espec√≠fico.

Partition Table
Ruta: Partition Table ‚Üí (Custom partition table CSV) ‚Üí Seleccion√°: partition.csv

Logging (opcional)
Ruta: Component config ‚Üí Log output
Configur√° el nivel en INFO o DEBUG para ver m√°s detalles.
Guard√° y sal√≠ (S ‚Üí Enter ‚Üí Q).
Reconfigur√° el proyecto: idf.py reconfigure

Archivo de particiones (partition.csv)
Pod√©s usar el mismo archivo del coordinador o uno b√°sico como este:

# Name,   Type, SubType, Offset,  Size, Flags
nvs,      data, nvs,     0x9000,  0x6000,
phy_init, data, phy,     0xf000,  0x1000,
factory,  app,  factory, 0x10000, 1M,
storage,  data, spiffs,  ,        512K,

Compilar y flashear
1Ô∏è) Compilar el proyecto: idf.py build
2Ô∏è) Flashear el firmware: idf.py -p COM9 flash
2.1) (Opcional) Borrar y volver a flashear: idf.py -p COM9 erase_flash build flash
3) Monitorear la salida: idf.py -p COM9 monitor

Salida esperada en el monitor
Si el coordinador (esp_zb_switch) est√° activo, deber√≠as ver algo como:
I (1500) ZIGBEE_END_DEVICE: Zigbee End Device iniciado, buscando red...
I (2500) ZIGBEE_END_DEVICE: Joined Zigbee network successfully
I (2520) APP_MAIN: Device is now active in the Zigbee network


Y en el coordinador:
I (3000) ZIGBEE_COORDINATOR: New device joined, short address: 0x5678

Notas finales
-El cliente no crea red: solo se une a una red Zigbee existente.
-Aseg√∫rate de que el coordinador est√© encendido antes de iniciar el cliente.
-Si el cliente no encuentra la red, revis√° el canal Zigbee y el PAN ID en menuconfig.
-Para limpiar en caso de errores de compilaci√≥n:

idf.py fullclean
idf.py build

Verificaci√≥n de comunicaci√≥n
Cuando ambos dispositivos est√©n funcionando:
En el Coordinador (esp_zb_switch) deber√≠as ver: I (3010) ZIGBEE_COORDINATOR: Device joined: 0x1234


En el Cliente (esp_zb_light) deber√≠as ver:

I (2500) ZIGBEE_END_DEVICE: Joined Zigbee network successfully
